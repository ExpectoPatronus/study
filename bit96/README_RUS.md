# bit96

Реализация собственной библиотеки bit96.h.

## Information

Тип bit96 представляет десятичные числа в диапазоне от положительных 79,228,162,514,264,337,593,543,950,335 до отрицательных 79,228,162,514,264,337,593,543,950,335. Значение bit96 по умолчанию равно 0. bit96 подходит для финансовых расчетов, которые требуют большого количества значимых целых и дробных цифр и отсутствия ошибок округления. Этот тип не устраняет необходимость округления. Скорее, сводит к минимуму количество ошибок из-за округления.

Когда результат деления и умножения передается методу округления, результат не страдает от потери точности.

bit96 число - это значение с плавающей точкой, состоящее из знака, числового значения, где каждая цифра находится в диапазоне от 0 до 9, и коэффициента масштабирования, который указывает положение десятичной точки, разделяющей целые и дробные части числового значения.

Двоичное представление bit96 состоит из 1-разрядного знака, 96-разрядного целого числа и коэффициента масштабирования, используемого для деления 96-разрядного целого числа и указания того, какая его часть является десятичной дробью. Коэффициент масштабирования неявно равен числу 10, возведенному в степень в диапазоне от 0 до 28. Следовательно, двоичное представление bit96 имеет вид ((от -2^96 до 2^96) / 10^(от 0 до 28)), где -(2^96-1) равно минимальному значению, а 2^96-1 равно максимальному значению.

Коэффициент масштабирования также может сохранять любые конечные нули в bit96. Эти конечные нули не влияют на значение в арифметических операциях или операциях сравнения. 

### Двоичное представление  

Двоичное представление bit96 состоит из 1-разрядного знака, 96-разрядного целого числа и коэффициента масштабирования, используемого для деления целого числа и указания того, какая его часть является десятичной дробью. Коэффициент масштабирования неявно равен числу 10, возведенному в степень в диапазоне от 0 до 28.

bit96 число может быть реализовано в виде четырехэлементного массива 32-разрядных целых чисел со знаком (`int bits[4];`).

`bits[0]`, `bits[1]`, и `bits[2]` содержат младшие, средние и старшие 32 бита 96-разрядного целого числа соответственно.

`bits[3]` содержит коэффициент масштабирования и знак, и состоит из следующих частей:
- Биты от 0 до 15, младшее слово, не используются и должны быть равны нулю.
- Биты с 16 по 23 должны содержать показатель степени от 0 до 28, который указывает степень 10 для разделения целого числа.
- Биты с 24 по 30 не используются и должны быть равны нулю.
- Бит 31 содержит знак; 0 означает положительный, а 1 означает отрицательный.

Обратите внимание, что битовое представление различает отрицательные и положительные нули. Эти значения могут считаться эквивалентными во всех операциях.

### Пример:

```c
typedef enum {
    dNORMAL_VALUE = 0,
    dINFINITY = 1,
    dNEGATIVE_INFINITY = 2,
    dNAN = 3
} value_type_t;

typedef struct 
{
    int bits[4];
    value_type_t value_type;
} bit96;
```

Поле value_type содержит информацию о виде числа, при значении dNORMAL_VALUE в массиве bits содержится число, при остальных значениях все элементы массива bits равны 0

### Арифметические операторы

| Название оператора | Оператор  | Функция | 
| ------ | ------ | ------ |
| Сложение | + | bit96 Add(bit96, bit96) |
| Вычитание | - | bit96 Sub(bit96, bit96) |
| Умножение | * | bit96 Mul(bit96, bit96) | 
| Деление | / | bit96 Div(bit96, bit96) |
| Остаток от деления | Mod | bit96 Mod(bit96, bit96) |

При ошибке во время операции в переменную value_type записывается тип ошибки

### Операторы сравнения (выполнено [ExpectoPatronus](https://github.com/ExpectoPatronus))

| Название оператора | Оператор  | Функция | 
| ------ | ------ | ------ |
| Меньше  | < | int IsLess(bit96, bit96) |
| Меньше или равно | <= | int IsLessOrEqual(bit96, bit96) | 
| Больше | \> |  int IsGreater(bit96, bit96) |
| Больше или равно | \>= | int IsGreaterOrEqual(bit96, bit96) | 
| Равно | == |  int IsEqual(bit96, bit96) |
| Не равно | != |  int IsNotEqual(bit96, bit96) |

Возвращаемое значение:
- 0 - TRUE
- 1 - FALSE

### Преобразователи (выполнено rleonard)
| Преобразователь | Функция | 
| ------ | ------ |
| Из int | int IntToBit96(int src, bit96 *dst) |
| Из float  | int FloatToBit96(float src, bit96 *dst) |
| В int  | int Bit96ToInt(bit96 src, int *dst) |
| В float  | int Bit96ToFloat(bit96 src, float *dst) |

Возвращаемое значение - код ошибки:
 - 0 - SUCCESS
 - 1 - CONVERTING ERROR

*Уточнение про преобразование числа типа float*
- *Если числа слишком малы (0 < |x| < 1e-28), вернуть ошибку и значение, равное 0, value_type = 0*
- *Если числа слишком велики (|x| > 79,228,162,514,264,337,593,543,950,335) или равны бесконечности, вернуть ошибку и value_type бесконечности с соответствующим знаком*
- *При обработке числа с типом float преобразовывать все содержащиеся в нём цифры*

### Другие функции (выполнено [ExpectoPatronus](https://github.com/ExpectoPatronus))

| Описание | Функция | 
| ------ | ------ |
| Округляет указанное bit96 число до ближайшего целого числа в сторону отрицательной бесконечности. | bit96 Floor(bit96) |	
| Округляет bit96 до ближайшего целого числа. | bit96 Round(bit96) |
| Возвращает целые цифры указанного bit96 числа; любые дробные цифры отбрасываются, включая конечные нули. | bit96 Truncate(bit96) |
| Возвращает результат умножения указанного bit96 на -1. | bit96 Negate(bit96) |


